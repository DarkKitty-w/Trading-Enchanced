name: Phoenix Trading Bot ü¶Ö

on:
  # 1. Programmation Automatique (CRON)
  # Le bot d√©marre √† 00:00, 06:00, 12:00 et 18:00 (UTC)
  schedule:
    - cron: '0 0,6,12,18 * * *'
  
  # 2. D√©marrage Manuel (Bouton "Run workflow")
  # Utile pour tester imm√©diatement sans attendre l'heure pile
  workflow_dispatch:

jobs:
  run-phoenix:
    name: Live Trading Session
    runs-on: ubuntu-latest
    # S√©curit√© : Si le bot plante et ne s'√©teint pas tout seul,
    # GitHub le tuera de force apr√®s 360 minutes (6h).
    timeout-minutes: 360 

    steps:
    # A. R√©cup√©ration du code
    - name: Checkout repository
      uses: actions/checkout@v4

    - name: Create Cache Folders
      run: |
        mkdir -p data_cache/BTC data_cache/ETH data_cache/SOL data_cache/BNB data_cache/XRP data_cache/ADA data_cache/DOGE

    # B. Installation de Python 3.10
    - name: Set up Python 3.10
      uses: actions/setup-python@v5
      with:
        python-version: '3.10'
        cache: 'pip' # Acc√©l√®re l'installation des librairies

    # C. Installation des d√©pendances
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt

    # D. Lancement du Bot
    - name: Run Phoenix Bot üöÄ
      env:
        # C'est ici qu'on injecte tes cl√©s s√©curis√©es stock√©es dans GitHub Secrets
        SUPABASE_URL: ${{ secrets.SUPABASE_URL }}
        SUPABASE_KEY: ${{ secrets.SUPABASE_KEY }}
      run: python main.py
